YUI.add("hermes-template-editor-upgrade-dialog",function(e,a){var t=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,a,t,s,i){var r=null!=a?a:{},n=t.helperMissing,l=e.escapeExpression;return'<div class="ui-dialog-wrapper c-dialog-cta-photorotate">\n\t<div class="ui-dialog-description js-description">\n\t\t<h3>'+l((t.intlMessage||a&&a.intlMessage||n).call(r,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.EDITOR_UPGRADE"},data:i}))+"</h3>\n\t\t<br>\n\t\t"+l((t.intlHTMLMessage||a&&a.intlHTMLMessage||n).call(r,{name:"intlHTMLMessage",hash:{intlName:"photo-page-scrappy.EDITOR_UPGRADE_MESSAGE"},data:i}))+"\n\t</div>\n</div>\n"},useData:!0}),s={};e.Array.each([],function(a){var t=e.Template.get("hermes/"+a);t&&(s[a]=t)}),e.Template.register("hermes/editor-upgrade-dialog",function(a,i){return i=i||{},i.partials=i.partials?e.merge(s,i.partials):s,t(a,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("photo-well-scrappy-edit-view",function(e,t){var o=require("hermes-core/flog")(t);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.nsid=e.nsid,this.photoId=e.photoId,this.backToURL=e.backToURL,this.context=e.context,""===this.get("container").get("innerHTML")&&this.setContainerWithTemplate("scrappy-edit-button",{loadingView:!0}),this.editorParams={nsid:this.nsid,photoId:this.photoId,backToURL:this.backToURL},this},loadState:function(){var t=this;return this.appContext.getViewer().signedIn?e.Promise.all([this.appContext.getModel("photo-models",t.photoId)]).then(function(o){var i=o[0];if(t.set("photo",i),i.getValue("owner").getValue("isMe")&&!t.appContext.forceServerRender)return t.appContext.getModel(t.context.modelName,t.context.params).then(function(e){t.set("contextModel",e)}).then(function(){var o=e.merge(t.context.params,{photoId:t.photoId,numNext:1,numPrev:1});return t.get("contextModel").getValue("photoContextList").getContext(o).then(function(){var e,o=t.get("contextModel").getValue("photoContextList").getList(),i=o.length;(e=o.map(function(e){return e.getValue("id")}).indexOf(t.photoId))>=0&&e<i&&t.set("nextPhotoModel",o[e+1]),e>0&&t.set("prevPhotoModel",o[e-1])})})}):e.Promise.resolve()},buildContainer:function(){var e=!1;return this.appContext.getViewer().signedIn&&(e=this.get("photo").getValue("owner").getValue("isMe")),this.setContainerWithTemplate("scrappy-edit-button",{viewerIsOwner:e}),this},activate:function(){var e=this.get("container");return e&&this.registerEventHandler(e.on("click",this.handleMenuButtonClick,this)),this},setupDropdown:function(t){var o,i,a=this.get("container"),n=this.get("photo"),l=n.getValue("owner").getValue("isMe"),s=!1,r=this,h=n.getValue("isVideo"),c=n.getValue("id");l&&(s=!0),o=e.URLHelper.getPhotoPage({photoId:n.getValue("id"),pathAlias:n.getValue("owner").getValue("pathAlias")}),i=this.templates("scrappy-edit-menu")({photoURL:o,photoId:c,viewerIsOwner:l,showDeleteLink:l,showRotateLink:l&&!h,showReplaceLink:l&&!h,isVideo:h,showEditLink:l&&!h,enableEdit:s}),this.editMenu&&(this.editMenu.close(),this.editMenu=null),this.editMenu=new e.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,preferTop:!0,showDropArrow:!0,anchorOffsetHorizontal:3,anchorOffsetVertical:10,anchorElement:a.one(".edit"),htmlMessage:i,closeOnScroll:!1,classList:"dialog-tooltip",hideModalOverlay:!0,autoSizeToContent:!0}),this.editMenu.on("activated",function(o){r.fire("subviewViewEvent","make in view",a),e.use("photo-editor-view",function(){t()})}),this.editMenu.on("closeDroparound",function(e){r.fire("subviewViewEvent","close in view")}),this.editMenu.show()},handleMenuButtonClick:function(t){var o=this;t.preventDefault(),e.rapidTracker.beacon(this.name,"editMenuClick"),this.appContext.experiments.fullscreen.getMode()||this.setupDropdown(function(){var e={},t=o.editMenu.get("container");o.appContext.auth.signedIn&&(e.deleteMenuItem=t.one(".delete-photo"),e.deleteMenuItem&&e.deleteMenuItem.on("click",o.handleDeletePhotoClick,o),e.rotateMenuItem=t.one(".rotate-photo"),e.rotateMenuItem&&e.rotateMenuItem.on("click",o.handleRotatePhotoClick,o),e.replaceMenuItem=t.one(".replace-photo"),e.replaceMenuItem&&e.replaceMenuItem.on("click",o.handleReplacePhotoClick,o),e.editorMenuItem=t.one(".edit-photo"),e.editorMenuItem&&e.editorMenuItem.on("click",o.handleEditClick,o))})},handleDeletePhotoClick:function(t){t.preventDefault();var o;this.editMenu.close(),(o=new e.Views.FluidModal({title:this.intlMessage({intlName:"photo-page-scrappy.DELETE_PHOTO"}),actionButtonLabel:this.intlMessage({intlName:"common.DELETE"}),actionButtonIsDangerous:!0,htmlMessage:this.intlMessage({intlName:"photo-page-scrappy.PERMANTENTLY_DELETE"}),appContext:this.appContext,dismissOnOverlayClick:!1,dismissOnActionClick:!0,classList:"scrappy-dialog",actionButtonDisabled:!1,showCancelButton:!0,hideModalOverlay:!1,showCancelX:!0})).on("actionClick",this.handleDeletePhotoConfirmClick.bind(this)),o.show(),e.rapidTracker.beacon(this.name,"deletePhotoClick")},handleDeletePhotoConfirmClick:function(t){var o,i=this,a=i.get("photo").getValue("owner"),n=i.get("nextPhotoModel"),l=i.get("prevPhotoModel");e.rapidTracker.beacon(this.name,"deletePhotoConfirmationClick"),i.deleteDialog&&i.deleteDialog.close(),this.appContext.callAPI("flickr.photos.delete",{photo_id:this.photoId}).then(function(t){o=n?e.URLHelper.getPhotoPage({photoId:n.getValue("id"),pathAlias:n.getValue("owner").getValue("pathAlias"),contextSuffix:i.get("contextModel").getValue("urlSuffix")}):l?e.URLHelper.getPhotoPage({photoId:l.getValue("id"),pathAlias:l.getValue("owner").getValue("pathAlias"),contextSuffix:i.get("contextModel").getValue("urlSuffix")}):a.getValue("url")+"?deleted="+i.photoId,e.config.win.location=o},function(e){i.showErrorDialog(i.intlMessage({intlName:"photo-page-scrappy.ERROR_DELETING_PHOTO"}))})},handleReplacePhotoClick:function(t){t.halt();var o=this;this.get("photo").getValue("isVideo")||(this.editMenu.close(),this.replaceDialog=new e.Views.FluidModal({appContext:this.appContext,htmlMessage:this.templates("replace-photo-dialog-content")(),classList:"scrappy-dialog dialog-modal",showCancelX:!0,dismissOnOverlayClick:!0,showHeader:!1,showFooter:!1,width:700}),this.replaceDialog.attachEvents({"input change:":function(e){e.halt();var t=e.target.getDOMNode().files[0];t&&(o._imgFile=t,o.replaceConfirm())},":submit":function(){o.replaceSubmit()}}),this.replaceDialog.on("close",function(){o._imgFileXhr&&o._imgFileXhr.abort(),o._imgFileXhr=null,o._imgFile=null,this.replaceDialog=null}),this.replaceDialog.show(),e.rapidTracker.beacon(this.name,"replacePhotoClick"))},replaceConfirm:function(){this.replaceDialog.set("htmlMessage",this.templates("replace-photo-dialog-content")({fileName:this._imgFile.name})),this.replaceDialog.buildContainer(),this.replaceDialog.activate(),e.rapidTracker.beacon(this.name,"replacePhotoConfirmationClick")},replaceSubmit:function(){var t,i,a,n,l,s=new FormData,r=this,h=e.config.flickr.api.hostname_client_replace;s.append("api_key",e.config.flickr.api.site_key),s.append("csrf",e.config.flickr.csrf.token),s.append("photo",this._imgFile,this._imgFile.name),s.append("photo_id",this.photoId),(t=this._imgFileXhr=new XMLHttpRequest).open("POST",h,!0),t.withCredentials=!0,n=function(i){var a="object"==typeof i?i.target.statusText:i+"",n="ERROR_REPLACING_PHOTO";r.replaceDialog.close(),t.statusText.indexOf("Filetype was not recognised")>0&&(n="ERROR_REPLACING_PHOTO_FILE_TYPE"),r.showErrorDialog(r.intlMessage({intlName:"photo-page-scrappy."+n})),e.config.win.beaconError("Replace error",window.location.href,{err:i,status:t.statusText}),o.error("error during upload",{statusText:a})},l=function(o){var i,a,l;try{(l=document.createElement("div")).innerHTML=o.target.responseText,(a=l.getElementsByTagName("rsp")[0]||"")&&(a=a.getAttribute("stat")||""),(i=l.getElementsByTagName("err")[0]||"")&&(i=i.getAttribute("msg")||"")}catch(e){a="",i=""}if("ok"!==a)return e.config.win.beaconError("Replace error from API response",window.location.href,{err:o.target.responseText,status:t.statusText}),n((a||"empty")+": "+(i||"no message"));r.replaceDialog.close(),window.location.reload()},this.replaceDialog.set("htmlMessage",this.templates("replace-photo-dialog-content")({fileName:this._imgFile.name,uploading:!0})),this.replaceDialog.buildContainer(),this.replaceDialog.activate(),a=this.replaceDialog.get("container").one("progress"),t.addEventListener("load",l),t.addEventListener("error",n),t.upload.addEventListener("progress",function(e){a.value=i=Math.floor(e.loaded/e.total*100),e.loaded===e.total&&a.removeAttribute("value")}),t.send(s)},handleRotatePhotoClick:function(t){t.halt();var o=this;this.get("photo").getValue("isVideo")||(this.editMenu.close(),this.rotateDialog=new e.Views.FluidModal({appContext:this.appContext,htmlMessage:this.templates("rotate-photo-dialog-content")({preview:o.get("photo").getSizeToFit({width:240,height:240})}),dismissOnOverlayClick:!0,showFooter:!1,showHeader:!1,showCancelX:!0,width:700,classList:"scrappy-dialog dialog-modal"}),this.rotateDialog.attachEvents({":select":function(t,i){t.target.ancestor(".c-rotations").all("img").removeClass("c-state-selected"),t.target.addClass("c-state-selected"),o._imgRotation=e.flutil.constrainToValues(i.rotation,["90","180","270"])},":submit":function(){o.rotateSubmit()}}),this.rotateDialog.on("close",function(){o.rotateDialog=null}),this.rotateDialog.show(),e.rapidTracker.beacon(this.name,"rotatePhotoClick"))},rotateSubmit:function(){var t,i=this,a=this.rotateDialog;a&&a.get("container")&&(t=a.get("container").one(".ui-dialog-buttonbar"))&&(t.addClass("loading"),t.append(this.templates("flickr-balls")({}))),this.appContext.callAPI("flickr.photos.transform.rotate",{photo_id:this.photoId,degrees:this._imgRotation||90}).then(function(){setTimeout(function(){a.close(),i.fire("subviewViewEvent","photo:reload")},2e3)},function(n){a&&a.get("container")&&(t=a.get("container").one(".ui-dialog-buttonbar"))&&t.removeClass("loading"),a.close(),i.showErrorDialog(i.intlMessage({intlName:"photo-page-scrappy.ERROR_ROTATING_PHOTO"})),e.config.win.beaconError("Rotation error",window.location.href,n),o.error("error during rotation",{err:n})}),e.rapidTracker.beacon(this.name,"rotatePhotoConfirmationClick")},handleEditClick:function(t){t.halt(),this.editMenu.close(),this.appContext.flipper.isFlipped("enable-new-photo-editor")?(this.appContext.getView("photo-editor-view",this.editorParams).then(function(e){return e.initialize().then(function(){e.activate()})}),e.rapidTracker.beacon(this.name,"editPhoto")):(this.editorMenu=new e.Views.FluidModal({appContext:this.appContext,htmlMessage:this.templates("editor-upgrade-dialog")(),classList:"scrappy-dialog dialog-modal",showCancelX:!0,dismissOnOverlayClick:!0,showHeader:!1,showFooter:!0,showCancelButton:!1,width:600}),this.editorMenu.show())},showErrorDialog:function(t){return this.errorDialog=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,showCancelButton:!1,title:this.intlMessage({intlName:"common.OOPS"}),actionButtonLabel:this.intlMessage({intlName:"common.OK"}),message:t,darkOverlay:!0}),this.errorDialog.show(),this.errorDialog}})},"@VERSION@",{requires:["flickr-view","flutil","hermes-template-dialog-cta-reboot","flickr-promise","fluid-modal-view","fluid-droparound-view","hermes-template-scrappy-edit-button","hermes-template-scrappy-edit-menu","hermes-template-replace-photo-dialog-content","hermes-template-rotate-photo-dialog-content","hermes-template-flickr-balls","hermes-template-editor-upgrade-dialog"],optional:[],langBundles:["common","photo-page-scrappy","photo-editor"]});YUI.add("hermes-lang-photo-editor_ko-kr",function(E,S){E.Intl.add("hermes/photo-editor","ko-KR",{FILTERS:["필터"],ORIENTATION:["방향"],ADJUST:["조정"],CROP:["자르기"],FOCUS:["포커스"],SELECTIVE_BLUR:["선택적 흐림"],BORDER:["테두리"],STICKER:["스티커"],TEXT:["텍스트"],BRUSH:["브러시"],FRAMES:["프레임"],BORDER_COLOR:["색상"],BORDER_THICKNESS:["두께"],TEXT_FOREGROUND:["전경"],TEXT_BACKGROUND:["배경"],TEXT_SIZE:["크기"],TEXT_FONT:["글꼴"],TEXT_ALIGNMENT:["맞춤"],TEXT_TO_FRONT:["앞쪽으로"],TEXT_DEFAULT_TEXT:["클릭하여 편집"],ORIENTATION_MINUS_90:["-90° 회전"],ORIENTATION_PLUS_90:["+90° 회전"],ORIENTATION_FLIP_H:["대칭 이동(H)"],ORIENTATION_FLIP_V:["대칭 이동(V)"],ADJUSTMENTS_BRIGHTNESS:["밝기"],ADJUSTMENTS_CONTRAST:["대비"],ADJUSTMENTS_SATURATION:["채도"],ADJUSTMENTS_EXPOSURE:["노출"],ADJUSTMENTS_SHADOWS:["그림자"],ADJUSTMENTS_HIGHLIGHTS:["강조"],ADJUSTMENTS_CLARITY:["투명도"],ADJUSTMENTS_GAMMA:["감마"],CROP_CUSTOM:["사용자 정의"],CROP_SQUARE:["사각형"],CROP_4_3:["4:3"],CROP_16_9:["16:9"],CROP_NONE:["없음"],CROP_ROTATION:["회전"],FOCUS_RADIAL:["방사형"],FOCUS_LINEAR:["선형"],FOCUS_BLUR_RADIUS:["흐림 반경"],FOCUS_NONE:["없음"],FILTERS_INTENSITY:["강도"],FILTERS_CATEGORIES_ALL:["모두"],FILTERS_CATEGORIES_RETRO:["레트로"],FILTERS_CATEGORIES_BW:["흑백"],FILTERS_CATEGORIES_SUMMER:["여름"],FILTERS_CATEGORIES_WINTER:["겨울"],FILTERS_CATEGORIES_SPECIAL:["스페셜"],STICKERS_BRIGHTNESS:["밝기"],STICKERS_CONTRAST:["대비"],STICKERS_SATURATION:["채도"],STICKERS_BLUR:["흐림"],STICKERS_FLIP:["대칭 이동"],STICKERS_FLIP_V:["대칭 이동(V)"],STICKERS_FLIP_H:["대칭 이동(H)"],STICKERS_TO_FRONT:["앞쪽으로"],STICKERS_CATEGORIES_ALL:["모두"],STICKERS_CATEGORIES_GLASSES:["유리"],STICKERS_CATEGORIES_HATS:["모자"],STICKERS_CATEGORIES_BEARDS:["턱수염"],STICKERS_CATEGORIES_MISC:["기타"],BRUSH_THICKNESS:["두께"],BRUSH_COLOR:["색상"],WEBCAM_TAKE_PHOTO:["사진을 찍으세요!"],EDITOR_EDIT_PHOTO:["사진 편집"],EDITOR_NEW:["신규"],EDITOR_PHOTO_ROLL:["포토 롤"],EDITOR_UNDO:["실행 취소"],EDITOR_EXPORT:["저장"],EDITOR_ZOOM:["확대/축소"],SPLASH_UPLOAD:["이미지 업로드"],SPLASH_UPLOAD_DESCRIPTION:["라이브러리에서 그림을 업로드하거나 끌어서 놓기만 하면 됩니다."],SPLASH_WEBCAM:["웹캠"],SPLASH_WEBCAM_DESCRIPTION:["웹캠 또는 전화로 사진 촬영"],SPLASH_STOCK:["무료 스톡 동영상"],SPLASH_STOCK_DESCRIPTION:["수천 개의 무료 스톡 사진에서 선택"],STOCK_SEARCH:["사진 검색"],STOCK_SEARCH_RESULTS:["${query}","에 대한 결과 검색"],BUTTONS_BACK:["뒤로"],BUTTONS_CANCEL:["취소"],BUTTONS_COLOR:["색상"],LOADING_RESIZING:["크기 조정 중..."],LOADING_EXPORTING:["저장 중..."],LOADING_LOADING:["불러오는 중..."],WARNINGS_RESIZED:["이미지 크기 조정됨"],WARNINGS_MAX_SIZE:["회원님의 이미지가 최대 크기인 ","${maxMegaPixels}","메가픽셀을 초과하므로 크기가 ","${width}","x","${height}","픽셀로 조정되었습니다."],WARNINGS_LIMIT_SIZE:["하드웨어 제한으로 인해 이미지 크기가 ","${width}","x","${height}","픽셀로 조정되었습니다."],ERRORS_LOADING:["이미지 로드 실패"],ERRORS_LOADING_MESSAGE:["${path}","에서 이미지를 로드할 수 없음"],ERRORS_WEBCAM_UNAVAILABLE:["웹캠 사용할 수 없음"],ERRORS_WEBCAM_UNAVAILABLE_MESSAGE:["웹캠 이미지를 표시할 수 없음(오류: ","${error}",")"],ERRORS_WEBCAM_NOT_SUPPORTED:["웹캠 지원되지 않음"],ERRORS_WEBCAM_NOT_SUPPORTED_MESSAGE:["브라우저에서 웹캠 기능이 지원되지 않습니다."],ERRORS_RENDER:["렌더링하는 동안 오류가 발생했습니다."],ERRORS_RENDER_MESSAGE:["이미지를 렌더링하는 동안 오류가 발생했습니다."],ERRORS_BROWSER:["오류가 발생했습니다."],ERRORS_BROWSER_MESSAGE:["브라우저에서 이미지를 렌더링하는 데 너무 오래 걸렸습니다. 작업 수를 줄여서 적용해 보세요.\n"],ERRORS_BROWSER_MULTIPLE_MESSAGE:["브라우저에서 이미지를 렌더링하는 데 너무 오래 걸렸습니다. 작업 수를 줄여서 적용해 보세요.\n"],ERRORS_STICKERS_LOAD:["스티커 로드 실패"],RETRY_DIALOG_MESSAGE:["평소보다 시간이 더 걸리고 있습니다. 변경 사항을 다시 저장하시겠습니까?"],SAVE_PHOTO:["이 사진 저장"],IMAGE_TOO_LARGE:["죄송하지만, 이 이미지는 너무 커서 편집할 수 없습니다. 50 메가픽셀 이하의 이미지로 다시 시도하세요."],NO_ORIGINAL_PHOTO:["원본 사진을 구할 수 없습니다. 다시 시도하세요."],CROSS_PLATFORM_EDIT_WARNING:["이 사진은 최근에 무선 기기에서 편집되었습니다. 이 사진 교체를 선택할 경우 무선 기기에서 지금까지 진행한 편집을 더 이상 실행 취소할 수 없게 됩니다."],SAVE:["새 복사본 저장"],EDIT:["Flickr 사진 편집기로 편집"],NO_VIDEOS_IN_EDITOR:["Flickr 사진 편집기로 비디오를 편집할 수 없습니다."],ERROR:["사진 편집기를 사용하는 도중에 오류가 발생했습니다. 다시 시도하세요."],FLICKR_PHOTO_EDITOR:["Flickr 사진 편집기"],CATEGORY_SHAPES:["모양"],CATEGORY_FOOD:["식음료"],CATEGORY_FUN:["재미있는 것들"],CATEGORY_WEAR:["입을 것들"],STICKER_SQUARE_OUTLINE:["사각형 윤곽"],STICKER_CIRCLE_OUTLINE:["원형 윤곽"],STICKER_ARROW:["화살표"],STICKER_TRIANGLE_OUTLINE:["삼각형 윤곽"],STICKER_LIGHTNING:["번개"],STICKER_X:["X"],STICKER_HEART:["하트"],STICKER_STAR:["별"],STICKER_BACON:["베이컨"],STICKER_BANANA:["바나나"],STICKER_BUBBLE_TEA:["버블 티"],STICKER_CAN:["캔"],STICKER_CHERRY:["체리"],STICKER_COFFEE:["커피"],STICKER_HOT_SAUCE:["핫 소스"],STICKER_ICE:["얼음"],STICKER_LOLLIPOP:["막대 사탕"],STICKER_MUSHROOM:["버섯"],STICKER_POPCORN:["팝콘"],STICKER_ROOTBEER:["루트 비어"],STICKER_SPORK:["스포크"],STICKER_BUBBLE_BLUE:["블루 버블"],STICKER_BUBBLE_PINK:["핑크 버블"],STICKER_DIAMOND:["다이아몬드"],STICKER_DICE:["주사위"],STICKER_FIRE:["불"],STICKER_FLAMINGO:["플라밍고"],STICKER_FLOWER_ROSE:["장미"],STICKER_FLOWER_TULIP:["튤립"],STICKER_GIFT_BOX:["선물 상자"],STICKER_MONEYBAG:["지갑"],STICKER_RAINBOW:["무지개"],STICKER_SKULL:["두뇌"],STICKER_TICKET:["티켓"],STICKER_BOBBLES:["거품"],STICKER_CROWN:["왕관"],STICKER_GLASSES_RAYBAND:["디자이너 선글라스"],STICKER_GLASSES_SPARKLE:["반짝이는 선글라스"],STICKER_GOOGLY_EYE:["구글리 아이"],STICKER_LIPS:["입술"],STICKER_MUSTACHE:["콧수염"],STICKER_PARTY_HAT_STARS:["별이 있는 파티 모자"],STICKER_PARTY_HAT_STRIPES:["줄무늬가 있는 파티 모자"],STICKER_TONGUE:["메롱"],STICKER_VIKING:["바이킹 헬멧"],SELECTIVE_BLUR_RADIUS:["흐림 반경"],SELECTIVE_BLUR_THICKNESS:["두께"],FRAME_NONE:["프레임 없음"],FRAME_SCALE:["스케일"]})},"@VERSION@",{requires:["intl"]});