YUI.add("notification-view",function(t,e){var i=require("hermes-core/flog")(e);t.flutil;t.namespace("Views")[this.name]=t.Base.create("notification-view",t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.notifId=t.id,this.object=t.object,this.objectType=t.objectType,this.subevents=t.events,this.isMuted=t.isMuted,this.notifModel=t.notifModel,this},loadState:function(){var e=this,i=[this.appContext.getModelRegistry("photo-group-invitations-models").then(function(t){e.invitationsModelRegistry=t}),this.appContext.getModelRegistry("notification-models").then(function(t){e.notificationsModelRegistry=t})];return t.Promise.all(i)},buildContainer:function(){var t,e,i={object:this.object,type:this.objectType,event:this.subevents[0],subCount:this.subevents.length-1,viewer:this.appContext.getViewer(),eventCount:this.subevents.length,events:this.subevents,hasMenu:!0};if("photo"===this.objectType){for(var n=0;n<i.events.length;n++)i.events[n].owner.url="/photos/"+i.events[n].owner.pathAlias||i.events[n].owner.id;"group-invite"!==i.event.type&&(i.people=this.getEventOwners(i.events),i.peopleCount=i.people.length,i.subPeopleCount=i.people.length-1),"comment"===i.event.type?e="notification-photo-comment":"fave"===i.event.type?e="notification-photo-fave":"gallery"===i.event.type?t="notification-added-to-gallery":"people"===i.event.type?(e="notification-person",i.object.owner.isMe||(i.hasMenu=!1)):"tag"===i.event.type?e="notification-tag":"photo_comment_mention"===i.event.type?e="notification-mention":"group_invite"===i.event.type?(i.groups=this.getEventGroups(i.events),i.groupsCount=i.groups.length,i.subGroupsCount=i.groups.length-1,t="notification-photo-group-invite"):"note"===i.event.type?e="notification-photo-note":"share"===i.event.type&&(e="notification-photo-share",i.hasMenu=!1)}else"person"===this.objectType?(i.event&&"contacted"===i.event.type?(i.event.owner.url="/photos/"+i.event.owner.pathAlias||i.event.owner.id,t="notification-person-follow"):i.event&&"friend_join"===i.event.type&&(t="notification-friend-join",i.hasMenu=!1),i.hasMenu=!1):"group"===this.objectType?i.event&&"group_user_invite"===i.event.type&&(t="notification-group-invite",i.hasMenu=!1):"discussion"===this.objectType?(!i.event||"topic_reply"!==i.event.type&&"reply_reply"!==i.event.type||(i.people=this.getEventOwners(i.events),i.peopleCount=i.people.length,i.subPeopleCount=i.people.length-1,i.replyUrl=i.object.url+"/"+i.event.replyId,t="notification-group-discussion-reply"),i.event&&"group_topic_new"===i.event.type&&(t="notification-group-topic-new",i.hasMenu=!1)):"gallery"===this.objectType?"comment"===i.event.type&&(i.people=this.getEventOwners(i.events),i.peopleCount=i.people.length,i.subPeopleCount=i.people.length-1,t="notification-gallery-comment"):"flickrmail"===this.objectType?(i.event&&"flickrmail"===i.event.type&&(t="notification-flickrmail"),i.hasMenu=!1):"testimonial"===this.objectType&&(i.event&&"testimonial"===i.event.type&&(t="notification-testimonial"),i.hasMenu=!1);return e&&(i.details=this.templates(e)(i),t="notification-photo-shell"),i.notifTemplate=this.templates(t)(i),this.setContainerWithTemplate("notification",i),this},activate:function(){var t=this.subevents[0],e={type:this.objectType,id:this.object.id,eventType:t.type,latestTimestamp:t.timestamp,isMuted:this.isMuted},i=this.get("container");return this.notificationsList=i.ancestor(".notifications-list"),this.listItem=i.ancestor("li.notification-list-item"),this.ctxMenuArrow=i.one(".notif-context-menu-caret"),this.notification=this.listItem.one(".notification"),this.ctxMenuArrow&&this.registerEventHandler(this.ctxMenuArrow.on("click",this.handleContextArrowClick.bind(this))),this.ctxMenu||(i.appendChild(this.templates("notification-context-menu")({})),this.ctxMenu=i.one(".notification-context-menu")),this.turnOffOption=this.ctxMenu.one(".turn-off-object-option"),this.turnOnOption=this.ctxMenu.one(".turn-on-object-option"),this.turnOffOption&&this.registerEventHandler(this.turnOffOption.on("click",this.handleMuteObjectClick.bind(this,e,!0))),this.turnOnOption&&this.registerEventHandler(this.turnOnOption.on("click",this.handleMuteObjectClick.bind(this,e,!1))),e.isMuted?(this.turnOffOption.addClass("hidden"),this.turnOnOption.removeClass("hidden"),this.notification.addClass("muted")):(this.turnOnOption.addClass("hidden"),this.turnOffOption.removeClass("hidden")),"group_invite"===t.type&&(this.actionContainer=i.one(".action-container"),this.acceptButton=this.actionContainer.one(".button.accept"),this.declineButton=this.actionContainer.one(".button.decline"),this.registerEventHandler(this.acceptButton.on("click",this.handleGroupInviteAcceptClick.bind(this))),this.registerEventHandler(this.declineButton.on("click",this.handleGroupInviteDeclineClick.bind(this)))),this},getTaggedPeople:function(t){for(var e=[],i=0;i<t.length;i++){for(var n=t[i],o={id:n.personTagged.id,name:n.personTagged.displayname,url:n.personTagged.profileURL},s=!1,a=0;a<e.length;a++)if(e[a].id===o.id){s=!0;break}s||e.push(o)}return e},getEventOwners:function(t){for(var e=[],i=0;i<t.length;i++){for(var n=t[i],o={id:n.owner.id,name:n.owner.displayname,url:n.owner.profileURL},s=!1,a=0;a<e.length;a++)if(e[a].id===o.id){s=!0;break}s||e.push(o)}return e},getEventGroups:function(t){for(var e=[],i=0;i<t.length;i++){for(var n=t[i],o={id:n.group.id,title:n.group.title,url:n.group.url,iconUrl:n.group.bestIconURL},s=!1,a=0;a<e.length;a++)if(e[a].id===o.id){s=!0;break}s||e.push(o)}return e},handleContextArrowClick:function(t){this.toggleContextMenu()},toggleContextMenu:function(){this.listItem.hasClass("expanded")?this.listItem.removeClass("expanded"):(this.notificationsList.all(".notification-list-item.expanded").each(function(t){t.removeClass("expanded")}),this.listItem.addClass("expanded"),this.ctxMenu.removeClass("fast-close"))},handleMuteObjectClick:function(t,e,i){var n=this,o={};o.object_type=t.type,o.object_id=t.id,o.event_type=t.eventType,o.mute_after=t.latestTimestamp,e?(n.turnOffOption.addClass("disabled"),this.notifModel.remoteUpdateMutedObjects(o,this.appContext).then(function(t){n.turnOffOption.addClass("hidden"),n.turnOffOption.removeClass("disabled"),n.turnOnOption.removeClass("hidden"),n.notification.addClass("muted"),n.toggleContextMenu()},function(t){n.turnOffOption.removeClass("disabled")})):(n.turnOnOption.addClass("disabled"),this.notifModel.remoteUpdateUnmutedObjects(o,this.appContext).then(function(t){n.turnOnOption.addClass("hidden"),n.turnOnOption.removeClass("disabled"),n.turnOffOption.removeClass("hidden"),n.notification.removeClass("muted"),n.listItem.hasClass("expanded")&&n.toggleContextMenu()},function(t){n.turnOnOption.removeClass("disabled")})),n.ctxMenu.addClass("fast-close")},handleGroupInviteAcceptClick:function(t){var e=this;return this.actionContainer.addClass("loading"),this.invitationsModelRegistry.remote.acceptInvitation({groupID:e.subevents[0].group.id,userID:e.appContext.getViewer().nsid,photoID:e.object.id},e.appContext).then(function(t){return e.actionContainer.removeClass("loading"),e.actionContainer.addClass("accepted"),e.removeNotification(),t}).catch(function(t){throw i.error("Error accepting invite to group",{err:t}),e.actionContainer.removeClass("loading"),t})},handleGroupInviteDeclineClick:function(t){var e=this;return this.actionContainer.addClass("loading"),this.invitationsModelRegistry.remote.declineInvitation({groupID:e.subevents[0].group.id,userID:e.appContext.getViewer().nsid,photoID:e.object.id},e.appContext).then(function(t){return e.actionContainer.removeClass("loading"),e.actionContainer.addClass("declined"),e.removeNotification(),t}).catch(function(t){throw i.error("Error declining invite to group",{err:t}),e.actionContainer.removeClass("loading"),t})},removeNotification:function(){var t=this,e=this.notifModel.getValue("notifications").getList();e=e.filter(function(e){return t.notifModel.getValue("notifications").remove({id:e.id}),t.notifId!==e.id}),this.notifModel.getValue("notifications").concat(e)}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-notifications","hermes-template-notification-photo-comment","hermes-template-notification-group-invite","hermes-template-notification-added-to-gallery","hermes-template-notification-photo-fave","hermes-template-notification-photo-shell","hermes-template-notification-person-follow","hermes-template-notification-tag","hermes-template-notification-person","hermes-template-notification-mention","hermes-template-notification-photo-group-invite","hermes-template-notification-photo-extra-info","hermes-template-notification-photo-note","hermes-template-notification-photo-share","hermes-template-notification-group-discussion-reply","hermes-template-notification-gallery-comment","hermes-template-notification-friend-join","hermes-template-notification-group-topic-new","hermes-template-notification-flickrmail","hermes-template-notification-testimonial","hermes-template-notification-context-menu","hermes-template-notification"],langBundles:["common","relative-dates","notifications"]});YUI.add("hermes-lang-relative-dates_ko-kr",function(_,T){_.Intl.add("hermes/relative-dates","ko-KR",{SECOND_LONG:["1초"],SECONDS_LONG:["${time}","초"],MINUTE_LONG:["1분"],MINUTES_LONG:["${time}","분"],HOUR_LONG:["1시간"],HOURS_LONG:["${time}","시간"],DAY_LONG:["1일"],DAYS_LONG:["${time}","일"],MONTH_LONG:["1개월"],MONTHS_LONG:["${time}","개월"],YEAR_LONG:["1년"],YEARS_LONG:["${time}","년"],SECOND_SHORT:["1초"],SECONDS_SHORT:["${time}","초"],MINUTE_SHORT:["1분"],MINUTES_SHORT:["${time}","분"],HOUR_SHORT:["1시간"],HOURS_SHORT:["${time}","시간"],DAY_SHORT:["1일"],DAYS_SHORT:["${time}","일"],MONTH_SHORT:["1개월"],MONTHS_SHORT:["${time}","개월"],YEAR_SHORT:["1년"],YEARS_SHORT:["${time}","년"],SECOND_LONG_FUTURE:["1초 안에"],SECONDS_LONG_FUTURE:["${time}","초 안에"],MINUTE_LONG_FUTURE:["1분 안에"],MINUTES_LONG_FUTURE:["${time}","분 안에"],HOUR_LONG_FUTURE:["1시간 안에"],HOURS_LONG_FUTURE:["${time}","시간 안에"],DAY_LONG_FUTURE:["1일 안에"],DAYS_LONG_FUTURE:["${time}","일 안에"],MONTH_LONG_FUTURE:["1개월 안에"],MONTHS_LONG_FUTURE:["${time}","개월 안에"],YEAR_LONG_FUTURE:["1년 안에"],YEARS_LONG_FUTURE:["${time}","년 안에"],FUTURE_SHORT_FUTURE:["${time}"," 안에"],SECOND_SHORT_FUTURE:["1초 안에"],SECONDS_SHORT_FUTURE:["${time}","초 안에"],MINUTE_SHORT_FUTURE:["1분 안에"],MINUTES_SHORT_FUTURE:["${time}","분 안에"],HOUR_SHORT_FUTURE:["1시간 안에"],HOURS_SHORT_FUTURE:["${time}","시간 안에"],DAY_SHORT_FUTURE:["1일 안에"],DAYS_SHORT_FUTURE:["${time}","일 안에"],MONTH_SHORT_FUTURE:["1개월 안에"],MONTHS_SHORT_FUTURE:["${time}","개월 안에"],YEAR_SHORT_FUTURE:["1년 안에"],YEARS_SHORT_FUTURE:["${time}","년 안에"],SECOND_LONG_PAST:["1초 전에"],SECONDS_LONG_PAST:["${time}","초 전에"],MINUTE_LONG_PAST:["1분 전에"],MINUTES_LONG_PAST:["${time}","분 전에"],HOUR_LONG_PAST:["1시간 전에"],HOURS_LONG_PAST:["${time}","시간 전에"],DAY_LONG_PAST:["1일 전에"],DAYS_LONG_PAST:["${time}","일 전에"],MONTH_LONG_PAST:["1개월 전에"],MONTHS_LONG_PAST:["${time}","개월 전에"],YEAR_LONG_PAST:["1년 전에"],YEARS_LONG_PAST:["${time}","년 전에"],SECOND_SHORT_PAST:["1초 전에"],SECONDS_SHORT_PAST:["${time}","초 전에"],MINUTE_SHORT_PAST:["1분 전에"],MINUTES_SHORT_PAST:["${time}","분 전에"],HOUR_SHORT_PAST:["1시간 전에"],HOURS_SHORT_PAST:["${time}","시간 전에"],DAY_SHORT_PAST:["1일 전에"],DAYS_SHORT_PAST:["${time}","일 전에"],MONTH_SHORT_PAST:["1개월 전에"],MONTHS_SHORT_PAST:["${time}","개월 전에"],YEAR_SHORT_PAST:["1년 전에"],YEARS_SHORT_PAST:["${time}","년 전에"],NO_DATE:["-"]})},"@VERSION@",{requires:["intl"]});YUI.add("hermes-lang-notifications_ko-kr",function(e,o){e.Intl.add("hermes/notifications","ko-KR",{NOTIF_PHOTO_FAVE:["<a href='","${ownerUrl}","'>","${owner}","</a> 님이 회원님의 ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}},"을 좋아합니다."],NOTIF_PHOTO_FAVE_MULTI:[{type:"plural",valueName:"count",options:{one:["<a href='","${ownerUrl}","'>","${owner}","</a> 님과 <a href='","${secondUrl}","'>","${secondOwner}","</a> 님이 회원님의 ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}}],other:["<a href='","${ownerUrl}","'>","${owner}","</a> 님과 그 외 ","${count}","명이 회원님의 ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}}]}},"을 좋아합니다."],NOTIF_PERSON_FOLLOW:["<a href='","${ownerUrl}","'>","${owner}","</a> 님이 현재 회원님을 팔로우하고 있습니다."],NOTIF_PHOTO_COMMENT_YOURS:['<a href="',"${personUrl}",'">',"${personName}","</a> 님이 회원님의 ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}},"에 댓글을 남겼습니다."],NOTIF_PHOTO_COMMENT_YOURS_MULTI:[{type:"plural",valueName:"count",options:{one:['<a href="',"${firstPersonUrl}",'">',"${firstPersonName}",'</a> 님과 <a href="',"${secondPersonUrl}",'">',"${secondPersonName}","</a> 님이 회원님의 ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}}],other:['<a href="',"${firstPersonUrl}",'">',"${firstPersonName}","</a> 님과 그 외 ","${count}","명이 회원님의 ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}}]}},"에 댓글을 남겼습니다."],NOTIF_PHOTO_COMMENT_OTHER:['<a href="',"${personUrl}",'">',"${personName}",'</a> 님이 <a href="',"${ownerUrl}",'">',"${ownerName}"," 님의</a> ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}},"에 댓글을 남겼습니다."],NOTIF_PHOTO_COMMENT_OTHER_MULTI:[{type:"plural",valueName:"count",options:{one:['<a href="',"${firstPersonUrl}",'">',"${firstPersonName}",'</a> 님과 <a href="',"${secondPersonUrl}",'">',"${secondPersonName}",'</a> 님이 <a href="',"${ownerUrl}",'">',"${ownerName}"," 님의</a> ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}}],other:['<a href="',"${firstPersonUrl}",'">',"${firstPersonName}","</a> 님과 그 외 ","${count}",'명이 <a href="',"${ownerUrl}",'">',"${ownerName}"," 님의</a> ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}}]}},"에 댓글을 남겼습니다."],NOTIF_MENTION:['<a href="',"${personUrl}",'">',"${personName}","</a> 님이 ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}},"에서 회원님을 언급했습니다."],NOTIF_MENTION_MULTI:[{type:"plural",valueName:"count",options:{one:['<a href="',"${personUrl}",'">',"${personName}",'</a> 님과 <a href="',"${secondPersonUrl}",'">',"${secondPersonName}","</a> 님"],other:['<a href="',"${personUrl}",'">',"${personName}","</a> 님과 그 외 ","${count}","명"]}},"이 ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}},"에서 회원님을 언급했습니다."],NOTIF_PHOTO_GROUP_INVITE:["<a href='","${ownerUrl}","'>","${owner}","</a> 님이 회원님의 ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}},"을 <a href='","${groupUrl}","'>","${groupName}","</a> 그룹에 추가할 수 있도록 회원님을 초대했습니다."],NOTIF_PHOTO_GROUP_INVITE_MULTI:["회원님은 회원님의 ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}},"을 ",{type:"plural",valueName:"count",options:{one:["<a href='","${groupUrl}","'>","${groupName}","</a> 그룹과 <a href='","${secondGroupUrl}","'>","${secondGroupName}","</a> 그룹"],other:["<a href='","${groupUrl}","'>","${groupName}","</a> 그룹과 그 외 ","${count}","개의 그룹"]}},"에 추가할 수 있도록 초대되었습니다."],NOTIF_GROUP_USER_INVITE:['회원님은 <a href="',"${groupUrl}",'">',"${groupName}","</a> 그룹에 가입할 수 있도록 초대되었습니다."],NOTIF_TAGS:['<a href="',"${personUrl}",'">',"${personName}","</a> 님이 회원님의 ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}},"에 태그를 추가했습니다."],NOTIF_TAGS_MULTI:[{type:"plural",valueName:"count",options:{one:['<a href="',"${personUrl}",'">',"${personName}",'</a> 님과 <a href="',"${secondPersonUrl}",'">',"${secondPersonName}","</a> 님"],other:['<a href="',"${personUrl}",'">',"${personName}","</a> 님과 그 외 ","${count}","명"]}},"이 회원님의 ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}},"에 태그를 추가했습니다."],NOTIF_GALLERY:["회원님의 ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}},'이 <a href="',"${galleryUrl}",'">',"${galleryName}","</a> 갤러리에 추가되었습니다."],NOTIF_GALLERY_MULTI:["회원님의 ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}},"이 ",{type:"plural",valueName:"count",options:{one:['<a href="',"${galleryUrl}",'">',"${galleryName}",'</a> 갤러리와 <a href="',"${secondGalleryUrl}",'">',"${secondGalleryName}","</a> 갤러리"],other:['<a href="',"${galleryUrl}",'">',"${galleryName}","</a> 갤러리와 그 외 ","${count}","개의 갤러리"]}},"에 추가되었습니다."],NOTIF_ADD_PERSON:['<a href="',"${personUrl}",'">',"${personName}","</a> 님이 회원님의 ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}},"에서 사람들에게 태그를 추가했습니다."],NOTIF_ADD_PEOPLE:[{type:"plural",valueName:"count",options:{one:['<a href="',"${personUrl}",'">',"${personName}",'</a> 님과 <a href="',"${secondPersonUrl}",'">',"${secondPersonName}","</a> 님"],other:['<a href="',"${personUrl}",'">',"${personName}","</a> 님과 그 외 ","${count}","명"]}},"이 회원님의 ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}},"에서 사람들에게 태그를 추가했습니다."],NOTIF_ADD_ME:['<a href="',"${ownerUrl}",'">',"${ownerName}","</a> 님이 ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}},"에서 회원님에게 태그를 추가했습니다."],NOTIF_NOTES:['<a href="',"${personUrl}",'">',"${personName}","</a> 님이 회원님의 ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}},"에 메모를 남겼습니다."],NOTIF_NOTES_MULTI:[{type:"plural",valueName:"count",options:{one:['<a href="',"${personUrl}",'">',"${personName}",'</a> 님과 <a href="',"${secondPersonUrl}",'">',"${secondPersonName}","</a> 님"],other:['<a href="',"${personUrl}",'">',"${personName}","</a> 님과 그 외 ","${count}","명"]}},"이 회원님의 ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}},"에 메모를 남겼습니다."],NOTIF_NOTES_OTHER:['<a href="',"${personUrl}",'">',"${personName}",'</a> 님이 <a href="',"${ownerUrl}",'">',"${ownerName}"," 님의</a> 사진에 댓글을 남겼습니다."],NOTIF_NOTES_OTHER_MULTI:[{type:"plural",valueName:"count",options:{one:['<a href="',"${personUrl}",'">',"${personName}",'</a> 님과 <a href="',"${secondPersonUrl}",'">',"${secondPersonName}",'</a> 님이 <a href="',"${ownerUrl}",'">',"${ownerName}"," 님의</a> 사진에 댓글을 남겼습니다."],other:['<a href="',"${personUrl}",'">',"${personName}","</a> 님과 ","${count}",'명의 다른 사람이 <a href="',"${ownerUrl}",'">',"${ownerName}"," 님의</a> 사진에 댓글을 남겼습니다."]}}],NOTIF_VIEW_RECENT_ACTIVITY:["최근 활동 보기"],NOTIFICATIONS:["알림"],NOTIF_SHARE:['<a href="',"${personUrl}",'">',"${personName}","</a> 님이 회원님과 ",{type:"select",valueName:"mediaType",options:{photo:["사진"],video:["동영상"],other:["사진"]}},"을 공유했습니다."],FLICKR_MAIL_COUNT_PAREN:["(","${count}",")"],FLICKR_GROUP_DISCUSSION_REPLY:['<a href="',"${personUrl}",'">',"${personName}",'</a> 님이 <a href="',"${groupUrl}",'">',"${groupName}",'</a> 그룹에서 <a href="',"${replyUrl}",'">',"${objectTitle}","</a> 토론에 대해 답변했습니다."],FLICKR_GROUP_DISCUSSION_REPLY_MULTI:[{type:"plural",valueName:"count",options:{one:['<a href="',"${personUrl}",'">',"${personName}",'</a> 님과 <a href="',"${secondPersonUrl}",'">',"${secondPersonName}","</a> 님"],other:['<a href="',"${personUrl}",'">',"${personName}","</a> 님과 그 외 ","${count}","명"]}},'이 <a href="',"${groupUrl}",'">',"${groupName}",'</a> 그룹에서 <a href="',"${replyUrl}",'">',"${objectTitle}","</a> 토론에 대해 답변했습니다."],NOTIF_GROUP_DISCUSSION_REPLY:['<a href="',"${personUrl}",'">',"${personName}",'</a> 님이 <a href="',"${groupUrl}",'">',"${groupName}",'</a> 그룹에서 <a href="',"${replyUrl}",'">',"${objectTitle}","</a> 토론에 대해 답변했습니다."],NOTIF_GROUP_DISCUSSION_REPLY_MULTI:[{type:"plural",valueName:"count",options:{one:['<a href="',"${personUrl}",'">',"${personName}",'</a> 님과 <a href="',"${secondPersonUrl}",'">',"${secondPersonName}","</a> 님"],other:['<a href="',"${personUrl}",'">',"${personName}","</a> 님과 그 외 ","${count}","명"]}},'이 <a href="',"${groupUrl}",'">',"${groupName}",'</a> 그룹에서 <a href="',"${replyUrl}",'">',"${objectTitle}","</a> 토론에 대해 답변했습니다."],NOTIF_ONBOARDING_TITLE:["새 소식 — 알림 센터"],NOTIF_ONBOARDING_DESCRIPTION:['여기에서 회원님의 최근 Flickr 활동에 대한 알림을 확인합니다. 또한, 이곳에서 <a href="/mail">FlickrMail</a>에 손쉽게 액세스할 수 있습니다. 이번에 새로 선보이는 기능을 유용하게 사용하실 수 있을 것입니다.'],NOTIF_GALLERY_COMMENT:['<a href="',"${personUrl}",'">',"${personName}",'</a> 님이 회원님의 <a href="',"${objectUrl}",'">',"${objectName}","</a> 갤러리에 댓글을 남겼습니다"],NOTIF_GALLERY_COMMENT_MULTI:[{type:"plural",valueName:"count",options:{one:['<a href="',"${personUrl}",'">',"${personName}",'</a> 님과 <a href="',"${secondPersonUrl}",'">',"${secondPersonName}",'</a> 님이 회원님의 <a href="',"${objectUrl}",'">',"${objectName}","</a> 갤러리에 댓글을 남겼습니다."],other:['<a href="',"${personUrl}",'">',"${personName}","</a> 님과 그 외 ","${count}",'명이 회원님의 <a href="',"${objectUrl}",'">',"${objectName}","</a> 갤러리에 댓글을 남겼습니다."]}}],NOTIF_FRIEND_JOIN:['회원님의 친구 <a href="',"${personUrl}",'">',"${personName}","</a> 님이 Flickr에 가입했습니다."],NOTIF_NEW_GROUP_DISCUSSION:['<a href="',"${personUrl}",'">',"${personName}",'</a> 님이 <a href="',"${groupUrl}",'">',"${groupName}",'</a> 그룹에서 <a href="',"${discussionUrl}",'">',"${discussionName}","</a> 토론을 생성했습니다."],NOTIF_FLICKRMAIL:["<a href='","${personUrl}","'>","${personName}","</a> 님이 보낸 메시지: <a href='","${mailUrl}","'>“","${mailTitle}","”</a>"],NOTIF_TURN_OFF_OBJECT:["이 게시물에 대한 알림 끄기"],NOTIF_TURN_ON_OBJECT:["이 게시물에 대한 알림 켜기"],NOTIF_HIDE_THIS:["이 알림 숨기기"],NOTIF_NOTHING_HERE:["새 알림을 받으면 여기에 표시됩니다."],NOTIF_OFF_FOR_POST:["이 게시물에 대한 알림이 꺼져 있습니다."],NOTIF_UNDO:["실행 취소"],NOTIF_TESTIMONIAL:['<a href="',"${personUrl}",'">',"${personName}",' <a href="',"${testimonialUrl}",'">추천 글</a>이 있습니다.'],GROUP_INVITE_ACCEPT:["초대 수락"],GROUP_INVITE_NO_THANKS:["참여 안 함"],GROUP_INVITE_ACCEPTED:["초대 수락함"],GROUP_INVITE_DECLINED:["초대 거부됨"],FLICKRMAIL_HAS_MOVED:['FlickrMail은 회원님의 설정 메뉴로 이동했습니다! <a class="open-account-droparound-button" role="button" >메뉴 열기</a>']})},"@VERSION@",{requires:["intl"]});YUI.add("notifications-view",function(t,i){require("hermes-core/flog")(i);t.namespace("Views")[this.name]=t.Base.create("notifications-view",t.FlickrView,[],{langBundles:this.details.langBundles,registries:{person:"person-models",photo:"photo-models",group:"group-info-models",gallery:"gallery-models"},initializer:function(t){var i=this.appContext.getViewer();return""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this.nsid=i&&i.signedIn?i.nsid:void 0,t.nsid=this.nsid,this.pageNum=0,this.pageSize=30,this.isFetchingNotifs=!1,this.scrollBottomLoadDist=300,this.endOfNotifs=!1,this.shouldFetchNotifs=t.shouldFetchNotifs,this.height=t.height,this.width=t.width,this.listHeight=t.listHeight,this.overflowX=t.overflowX,this.overflowY=t.overflowY,this.notifFilter=t.notifFilter,this},loadState:function(){return this},buildContainer:function(){return this.setContainerWithTemplate("notifications",{notifications:[],height:this.height,width:this.width,listHeight:this.listHeight,overflowX:this.overflowX,overflowY:this.overflowY}),this},activate:function(){var t,i,e,o,n,s=this;return s.scrollContainer=s.get("container").one(".notifications-list"),s.scrollContainerElement=this.scrollContainer.getDOMNode(),this.registerEventHandler(s.scrollContainer.on("scroll",s.handleScrollNotifications.bind(s))),s.get("personNotificationsModels")?s.getMoreNotifications():(t=this.appContext.getViewer(),this.appContext.getModel("person-notifications-models",t.nsid).then(function(t){s.set("personNotificationsModels",t),e=t.getValue("notifications").size(),o=t.getValue("unseenNotificationCount"),s.shouldFetchNotifs&&0!==o||0===e||t.getValue("muteChanged")?(s.shouldFetchNotifs=!1,t.setValue("unseenNotificationCount",0),t.setValue("muteChanged",!1),s.get("container").one(".notifications-list").addClass("loading"),s.getMoreNotifications()):(n=t.getValue("notifications").getList(),s.pageNum=Math.floor(e/s.pageSize),s.appendPage(n)),(i=t.getValue("unreadFlickrMailCount"))&&0!==i&&s.get("container").one(".flickr-mail-count").setHTML(s.intlMessage({intlName:"notifications.FLICKR_MAIL_COUNT_PAREN",count:i}))})),this},handleflickrMailOpenAccountDropAroundClicked:function(i){i.stopPropagation(),i.preventDefault(),t.fire("notifications:openAccountMenuClicked"),t.fire("notifications:closeNotificationsMenuClicked")},handleflickrMailHasMovedClicked:function(t){t.stopPropagation(),t.preventDefault(),this.get("container").one(".notifications-flickrmail-has-moved-messaging-container").addClass("expand")},handleflickrMailHasMovedCloseClicked:function(t){t.stopPropagation(),t.preventDefault(),this.get("container").one(".notifications-flickrmail-has-moved-messaging-container").removeClass("expand")},handleScrollNotifications:function(t){this.isFetchingNotifs||this.scrollContainerElement.offsetHeight+this.scrollContainerElement.scrollTop+this.scrollBottomLoadDist>=this.scrollContainerElement.scrollHeight&&this.getMoreNotifications()},getMoreNotifications:function(){this.endOfNotifs||(this.isFetchingNotifs=!0,this.showBalls(this.get("container").one(".notifications-list")),this.retrieveNotifsPage())},appendPage:function(i){var e=this;i.forEach(function(i){var o=i.toJSON();o.appContext=e.appContext,o.notifModel=e.get("personNotificationsModels"),o.events&&0!==o.events.length&&new t.Views["notification-view"](o).initialize(o).then(function(n){var s=t.Node.create('<li class="notification-list-item"></li>');e.get("container").one(".notifications-list").append(s),o.seen||s.addClass("unseen"),s.setHTML(n.get("container")),i.setValue("seen",!0),n.activate()})})},showBalls:function(i){this.balls||(this.balls=t.Node.create('<li class="loading-balls"></li>'),this.balls.setHTML(this.templates("flickr-balls")({}))),(i||this.get("container")).append(this.balls)},hideBalls:function(){this.balls&&this.balls.remove()},retrieveNotifsPage:function(){var t=this,i=t.get("personNotificationsModels");return i.getValue("notifications").getPage({page:t.pageNum+1,apiParams:{filter:t.notifFilter}}).then(function(e){return 0!==e.length?(t.pageNum++,t.set("personNotifications",i.getValue("notifications")),t.appendPage(e)):(0===t.pageNum&&t.get("container").one(".notifications-empty-state").removeClass("hidden"),t.endOfNotifs=!0),t.get("container").one(".notifications-list").removeClass("loading"),t.hideBalls(),t.isFetchingNotifs=!1,t},function(t){}).then(function(t){t.registerEventHandler(t.get("container").all("a").on("focus",function(i){var e=i.target.ancestor("li");e&&t.findFocus.call(this,e)}.bind(t)))})},findFocus:function(t){var i,e=t.one("a.photo");e?e.focus():(i=t.one("a:first-child"))&&i.focus()}})},"@VERSION@",{requires:["flickr-view","hermes-template-notifications"],langBundles:["common","notifications"],optional:["person-notifications-models","notification-view","photo-models","group-info-models","person-models","gallery-models"]});YUI.add("notifications-menu-view",function(t){"use strict";t.namespace("Views")[this.name]=t.Base.create("notifications-menu-view",t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.pollingFailed=!1,this.shouldFetchNotifs=!0,this.notifFilter=["group_topic_new","user_gallery_comment"].join(","),""===this.get("container").get("innerHTML")&&this.setContainerWithTemplate("notifications-menu"),this},loadState:function(){var e=this,n=this.appContext.getViewer();return this.appContext.getModel("person-notifications-models",n.nsid).then(function(i){if(e.set("personNotificationsModel",i),Date.now()-i.getValue("unseenLastFetchedTimestamp")>t.config.flickr.notifications.loading_count_refetch_delay)return i.remoteReadUnseenNotificationCount({id:n.nsid,filter:e.notifFilter},e.appContext).then(null,function(t){e.pollingFailed=!0})})},buildContainer:function(){var t=this.formatCount99(this.get("personNotificationsModel").getValue("unseenNotificationCount"));return this.setContainerWithTemplate("notifications-menu",{unseenNotificationCount:t}),this},activate:function(){var e=this,n=e.get("personNotificationsModel");e.unseenBadge=e.get("container").one(".c-notification-unseencount"),e.unseenCount=0,e.notifIcon=e.get("container").one(".c-notification-icon"),0===n.getValue("unseenNotificationCount")?e.unseenBadge.addClass("hidden"):e.unseenBadge.removeClass("hidden"),t.on("notifications:closeNotificationsMenuClicked",function(t){e.droparound.close()}),this.registerEventHandler(this.get("container").on("click",e.openMenu.bind(e))),this.registerEventHandler(this.get("container").on("key",e.keyboardToggleMenu.bind(e),"down:13,32")),this.registerEventHandler(this.get("container").on("key",e.enterMenu.bind(e),"down:9,40")),e.pollForUnseenNotifs()},pollForUnseenNotifs:function(){this.pollIntervalId=setInterval(this.readUnseenNotifs.bind(this),t.config.flickr.notifications.polling_delay)},readUnseenNotifs:function(){var e=this,n=this.appContext.getViewer();e.get("personNotificationsModel").remoteReadUnseenNotificationCount({id:n.nsid,filter:e.notifFilter},e.appContext).then(function(t){e.shouldFetchNotifs=!0,t!==e.unseenCount&&(e.unseenCount=t,0!==t?(e.unseenBadge.removeClass("hidden"),e.unseenBadge.set("text",e.formatCount99(t))):e.unseenBadge.addClass("hidden"))},function(n){clearInterval(e.pollIntervalId),e.pollingFailed||(e.pollingFailedTimeoutId=setTimeout(e.pollForUnseenNotifs.bind(e),t.config.flickr.notifications.polling_failure_timeout)),e.pollingFailed=!0})},openMenu:function(){this.revealNotifications()},keyboardToggleMenu:function(t){t.preventDefault(),!this.droparound||this.droparound.isClosed?this.revealNotifications():this.droparound.close()},enterMenu:function(t){var e=t.keyCode;if(9===e&&!t.shiftKey&&"true"===t.target.getAttribute("aria-expanded")||40===e){t.preventDefault();var n=this.droparound.get("container").one("div.notifs-droparound");if(n){var i=n.one("a.mail-icon");this.registerEventHandler(i.on("key",this.enterNotificationsList.bind(this),"down:9,40")),i.focus()}}},enterNotificationsList:function(t){var e=t.keyCode;(9===e&&!t.shiftKey||40===e)&&(t.preventDefault(),this.droparound.get("subview").findFocus.call(this,this.droparound.get("container").one("div.notifs-droparound").one("ul").one("li:not(.hidden)")))},revealNotifications:function(){var e,n=this.appContext.viewportData.getWidth(),i=this.appContext.viewportData.getHeight(),o=n>700?60:67,s=n>700?"":n-2+"px",a=i>1e3?"800px":i-200+"px";(e=new t.Views["notifications-view"]({appContext:this.appContext,width:s,listHeight:a,shouldFetchNotifs:this.shouldFetchNotifs,notifFilter:this.notifFilter})).appContext=this.appContext,this.droparound=new t.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,anchorOffsetVertical:-4,anchorOffsetHorizontal:o,mirrorArrowAdjustment:o-11,showDropArrow:!0,contentPadding:0,classList:"notifs-droparound no-border big-shadow",anchorElement:this.get("container").one(".c-notification-icon"),subview:e,observePageResize:!0,positionFixed:!0,autoSizeToContent:!0,preventPageScrollOnScroll:!0}),this.droparound.show(),this.unseenBadge.addClass("hidden"),this.shouldFetchNotifs=!1},formatCount99:function(t){return t>=100?"99+":t},destructor:function(){clearInterval(this.pollIntervalId),clearTimeout(this.pollingFailedTimeoutId)}})},"@VERSION@",{requires:["flickr-view","hermes-template-notifications-menu","fluid-droparound-view","notifications-view"],langBundles:["notifications","common"]});YUI.add("hermes-template-person-card",function(a,n){var l=a.Template.Handlebars.revive({1:function(a,n,l,e,t){var s;return"\t\t\t\t\t"+a.escapeExpression(a.lambda(null!=(s=null!=n?n.person:n)?s.realname:s,n))+"\n\t\t\t\t\t"+(null!=(s=l.if.call(null!=n?n:{},null!=n?n.personLocation:n,{name:"if",hash:{},fn:a.program(2,t,0),inverse:a.noop,data:t}))?s:"")+"\n"},2:function(a,n,l,e,t){return" - "},4:function(a,n,l,e,t){var s;return null!=(s=l.each.call(null!=n?n:{},null!=n?n.photostream:n,{name:"each",hash:{},fn:a.program(5,t,0),inverse:a.noop,data:t}))?s:""},5:function(a,n,l,e,t){var s;return null!=(s=l.if.call(null!=n?n:{},null!=n?n.needsInterstitial:n,{name:"if",hash:{},fn:a.program(6,t,0),inverse:a.program(8,t,0),data:t}))?s:""},6:function(a,n,l,e,t){var s,r,i=null!=n?n:{},o=l.helperMissing,u=a.escapeExpression,c=a.lambda;return'\t\t\t\t\t<a href="'+u("function"==typeof(r=null!=(r=l.url||(null!=n?n.url:n))?r:o)?r.call(i,{name:"url",hash:{},data:t}):r)+'" title="'+u("function"==typeof(r=null!=(r=l.title||(null!=n?n.title:n))?r:o)?r.call(i,{name:"title",hash:{},data:t}):r)+'" width="'+u(c(null!=(s=null!=(s=null!=n?n.sizes:n)?s.sq:s)?s.width:s,n))+'" height="'+u(c(null!=(s=null!=(s=null!=n?n.sizes:n)?s.sq:s)?s.height:s,n))+'" style="background: url(https://combo.staticflickr.com/pw/images/spaceball.gif);" data-track="personCardRecentPhotosClick"></a>\n'},8:function(a,n,l,e,t){var s,r,i=null!=n?n:{},o=l.helperMissing,u=a.escapeExpression;return'\t\t\t\t\t<a href="'+u("function"==typeof(r=null!=(r=l.url||(null!=n?n.url:n))?r:o)?r.call(i,{name:"url",hash:{},data:t}):r)+'" title="'+u("function"==typeof(r=null!=(r=l.title||(null!=n?n.title:n))?r:o)?r.call(i,{name:"title",hash:{},data:t}):r)+'" style="background: url('+u(a.lambda(null!=(s=null!=(s=null!=n?n.sizes:n)?s.sq:s)?s.displayUrl:s,n))+');" data-track="personCardRecentPhotosClick"></a>\n'},10:function(a,n,l,e,t){return'\t\t\t<span class="tertiary">'+a.escapeExpression((l.intlMessage||n&&n.intlMessage||l.helperMissing).call(null!=n?n:{},{name:"intlMessage",hash:{intlName:"person.NO_PHOTOS"},data:t}))+"</span>\n"},compiler:[7,">= 4.0.0"],main:function(a,n,l,e,t){var s,r,i=null!=n?n:{},o=l.helperMissing,u=a.escapeExpression,c=a.lambda;return'\n<div>\n\t<section>\n\t\t<div class="follow-subview">'+u((l.outlet||n&&n.outlet||o).call(i,null!=n?n["follow-view"]:n,{name:"outlet",hash:{},data:t}))+'</div>\n\n\t\t<div class="attribution">\n\t\t\t<a href="'+u(c(null!=(s=null!=n?n.personURLS:n)?s.photostream:s,n))+'" data-track="personCardAttributionNameClick">\n\t\t\t\t<h3 class="fade-out">'+u(c(null!=(s=null!=n?n.person:n)?s.username:s,n))+'</h3>\n\t\t\t</a>\n\t\t</div>\n\t\t<div class="info">\n\t\t\t<span class="secondary realname fade-out">\n'+(null!=(s=l.if.call(i,null!=(s=null!=n?n.person:n)?s.realname:s,{name:"if",hash:{},fn:a.program(1,t,0),inverse:a.noop,data:t}))?s:"")+"\t\t\t\t"+u("function"==typeof(r=null!=(r=l.personLocation||(null!=n?n.personLocation:n))?r:o)?r.call(i,{name:"personLocation",hash:{},data:t}):r)+'\n\t\t\t</span>\n\t\t</div>\n\n\t\t<div class="recent-photos">\n'+(null!=(s=l.if.call(i,null!=n?n.photostream:n,{name:"if",hash:{},fn:a.program(4,t,0),inverse:a.program(10,t,0),data:t}))?s:"")+'\t\t</div>\n\t</section>\n</div>\n\n<div class="links secondary">\n\t<a href="'+u(c(null!=(s=null!=n?n.personURLS:n)?s.sendFlickrMail:s,n))+'" data-track="personCardMessageClick">'+u((l.intlMessage||n&&n.intlMessage||o).call(i,{name:"intlMessage",hash:{intlName:"person.MESSAGE"},data:t}))+'</a>\n\t<a href="'+u(c(null!=(s=null!=n?n.personURLS:n)?s.albums:s,n))+'" data-track="personCardAlbumsClick">'+u((l.intlMessage||n&&n.intlMessage||o).call(i,{name:"intlMessage",hash:{intlName:"person.ALBUMS"},data:t}))+'</a>\n\t<a href="'+u(c(null!=(s=null!=n?n.personURLS:n)?s.favorites:s,n))+'" data-track="personCardFavesClick">'+u((l.intlMessage||n&&n.intlMessage||o).call(i,{name:"intlMessage",hash:{intlName:"person.FAVES"},data:t}))+'</a>\n\t<a class="align-right" href="'+u(c(null!=(s=null!=n?n.personURLS:n)?s.profile:s,n))+'" data-track="personCardProfileClick">'+u((l.intlMessage||n&&n.intlMessage||o).call(i,{name:"intlMessage",hash:{intlName:"common.ABOUT"},data:t}))+"</a>\n</div>\n"},useData:!0}),e={};a.Array.each([],function(n){var l=a.Template.get("hermes/"+n);l&&(e[n]=l)}),a.Template.register("hermes/person-card",function(n,t){return t=t||{},t.partials=t.partials?a.merge(e,t.partials):e,l(n,t)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("person-card-view",function(e){e.namespace("Views")[this.name]=e.Base.create("person-card-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.nsid=e.nsid,this.pathAlias=e.pathAlias,this.set("isActiveViewAgnostic",e.isActiveViewAgnostic||!1),""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},subviewConfig:{"follow-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1}},loadState:function(){var t=this,s={contentType:7};return this.nsid?s.id=this.nsid:s.pathAlias=this.pathAlias,new e.FlickrPromise({person:this.appContext.getModel("person-models",s),photostream:this.appContext.getModel("photostream-models",s),personProfile:this.appContext.getModel("person-profile-models",s)}).then(function(e){return t.personModel=e.person,t.personLocation=e.personProfile.getValue("location"),e.photostream.getValue("photoPageList").getPage({page:1,perPage:5}).then(function(e){t.photostreamPhotos=e})},function(e){t.loadingError=!0,1===e.code&&"User not found"===e.message&&(t.badUser=!0)})},buildContainer:function(){var t,s;return this.loadingError?(s=this.badUser?'<span class="no-user">'+this.intlMessage({intlName:"person.NO_LONGER_ON_FLICKR"})+"</span>":'<span class="error-user">'+this.intlMessage({intlName:"person.ERROR_LOADING"})+"</span>",this.setContainerHTML(s)):(t=this.personModel.toJSON(),this.setContainerWithTemplate("person-card",{person:t,photostream:this.photostreamPhotos.map(function(e){return e.toJSON()}),personLocation:this.personLocation,personURLS:e.URLHelper.generatePersonUrls(this.personModel)})),this},activate:function(){var e=this.get("container"),t=e.one(".follow-view"),s=t.one(".relationship"),o=t.one(".relationship > .is-following"),n=e.one(".attribution");return s?o&&n.addClass("shorter"):n.addClass("full"),this}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-person-card","url-helper"],langBundles:["person","common"]});YUI.add("hermes-lang-person_ko-kr",function(O,_){O.Intl.add("hermes/person","ko-KR",{MESSAGE:["메시지"],ALBUMS:["앨범"],FAVES:["즐겨찾기"],PROFILE:["프로필"],NO_PHOTOS:["이 사용자의 사진을 볼 수 없습니다."],NO_LONGER_ON_FLICKR:["사용자를 찾을 수 없거나 더 이상 Flickr 사용자가 아닙니다."],ERROR_LOADING:["사용자 카드를 불러오는 중 오류가 발생했습니다. 다시 시도하세요."],RELATIONSHIP_FRIEND_ERROR:["친구 관계를 설정하는 중에 문제가 발생했습니다."],RELATIONSHIP_FAMILY_ERROR:["가족 관계를 설정하는 중에 문제가 발생했습니다."],SIGN_IN_BEFORE_FOLLOW_TITLE:["팔로우할 사람을 찾으셨습니다!"],SIGN_IN_BEFORE_FOLLOW_MESSAGE:["놀랍습니다. 이제 로그인하여 팔로우하시면 됩니다."],JOIN_FLICKR_AND_FOLLOW:["Flickr에 가입하고 ","${person}","의 게시물을 놓치지 마세요."],SIGN_IN_AND_FOLLOW:["로그인한 후 팔로우하세요!"],CURATOR_PASS_OVER:["큐레이터 프로그램 불참"],CURATOR_PASS_OVER_UNDO:["큐레이터 프로그램 참여"]})},"@VERSION@",{requires:["intl"]});